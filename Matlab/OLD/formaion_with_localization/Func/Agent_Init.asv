
% Declare Agent
Leader = struct('node', 'Leader', ...
    'mode', 'formation', ...
    'localization_flag', true, ...
    'pos', zeros(dim_xy,1), ...
    'pos_dot', zeros(dim_xy,1), ...
    'att', zeros(dim_th,1), ...
    'att_dot', zeros(dim_th,1), ...
    'formation_global', zeros(dim_xy,1), ...
    'formation_local', zeros(dim_xy,1), ...
    'feedback_linearized', zeros(dim_xy,1), ...
    'localization_input', zeros(dim_xy, 1));

F1 = struct('node', 'Follower 1', ...
    'mode', 'formation', ...
    'localization_flag', true, ...
    'pos', zeros(dim_xy,1), ...
    'pos_dot', zeros(dim_xy,1), ...
    'att', zeros(dim_th,1), ...
    'att_dot', zeros(dim_th,1), ...
    'formation_global', zeros(dim_xy,1), ...
    'formation_local', zeros(dim_xy,1), ...
    'feedback_linearized', zeros(dim_xy,1), ...
    'localization_input', zeros(dim_xy, 1));

F2 = struct('node', 'Follower 2', ...
    'mode', 'localization', ...
    'localization_flag', true, ...
    'pos', zeros(dim_xy,1), ...
    'pos_dot', zeros(dim_xy,1), ...
    'att', zeros(dim_th,1), ...
    'att_dot', zeros(dim_th,1), ...
    'formation_global', zeros(dim_xy,1), ...
    'formation_local', zeros(dim_xy,1), ...
    'feedback_linearized', zeros(dim_xy,1), ...
    'localization_input', zeros(dim_xy, 1));

L = struct('D', 0, ...
    'zeta1', 0, ...
    'zeta2', zeros(dim_xy,1), ...
    'zeta1_dot', 0, ...
    'zeta2_dot', zeros(dim_xy,1), ...
    'alpha', 1, ...
    'gamma', 1, ...
    'z_fil', 0, ...
    'phi_fil', zeros(dim_xy,1), ...
    'z_hat', 0, ...
    'x_hat_dot', zeros(dim_xy,1), ...
    'x_hat', zeros(dim_xy,1), ...
    'tol_cnt', 1, ...
    'TOL_TIME', 10, ...
    'tol_ts', 0, ...
    'tol_tf', 0, ...
    'LOCALIZATION_TOLERANCE', 1e-3);

A = [Leader, F1, F2];

% Set initial point
if(strcmp(F.formation_mode,"Random"))
    pos0 = r*(rand(d(1), n) - 0.5);
    att0 = 2*pi*(rand(d(2), n) - 0.5);
else
    pos0 = [-0.7417,    0.4263,    2.0860; % x
        1.6541,    0.2486,   -1.0708]; % y
    att0 = [1.6160    2.3825    1.6344];
end

for k=1:n_agent
    A(k).pos = pos0(:,k);
    A(k).att = att0(k);
end
